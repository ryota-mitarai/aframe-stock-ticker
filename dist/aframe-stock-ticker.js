function t(t,e,i,a){return new Promise(function(r,n){fetch("https://twelve-data1.p.rapidapi.com/time_series?symbol="+t+"&interval="+e+"&outputsize="+i+"&format=json",{method:"GET",headers:{"x-rapidapi-key":a,"x-rapidapi-host":"twelve-data1.p.rapidapi.com"}}).then(function(t){t.json().then(function(t){r(t)})}).catch(function(t){n(t)})})}function e(t,e){return new Promise(function(i,a){fetch("https://api.coingecko.com/api/v3/coins/ethereum/ohlc?vs_currency=usd&days="+e).then(function(a){a.json().then(function(a){var r=[];a.forEach(function(t){r.push({open:t[1],high:t[2],low:t[3],close:t[4]})});var n=e<=2?"30 min":e>=31?"4 day":"4 hour",o=Math.ceil(e<=2?24*e/.5:e>=31?e/4:24*e/4)+1;i({meta:{symbol:t,interval:n,numCandles:o},values:r})})}).catch(function(t){a(t)})})}AFRAME.registerComponent("stock-chart",{schema:{symbol:{default:"AMC"},interval:{default:"15min"},length:{default:100},refreshRate:{default:5},width:{default:4},height:{default:2},backgroundColor:{default:"#333"},enableBackground:{default:!0},enableTitle:{default:!0},enablePrices:{default:!0},enableWicks:{default:!0}},init:function(){var e=this,i=this.data;t(i.symbol,i.interval,i.length,window.TWELVE_API_KEY).then(function(t){e.timeseries=t,i.timeseries=t,e.updateChart()}),setInterval(function(){t(i.symbol,i.interval,i.length,window.TWELVE_API_KEY).then(function(t){e.timeseries=t,i.timeseries=t,e.updateChart()})},1e3*i.refreshRate*60)},updateChart:function(){for(var t=this.el,e=this.data,i=e.length,a=e.width,r=e.height,n=e.timeseries,o=n.values;t.firstChild;)t.firstChild.remove();var u=o.map(function(t){return t.high}),s=o.map(function(t){return t.low}),h=Math.max.apply(Math,u),l=Math.min.apply(Math,s);function d(t){return(t-l)/(h-l)*r}var c=a/i,b=0;if(o.forEach(function(i){b++;var a=document.createElement("a-box");t.appendChild(a),a.setAttribute("width",c),a.setAttribute("depth",c);var r=d(i.open)-d(i.close);a.setAttribute("height",Math.abs(r));var n=b*c-c/2,o=r<0?Math.abs(r)/2:Math.abs(r)/-2,u=d(i.open)+o;a.setAttribute("position",n+" "+u+" 0");var s=r<0?"#f44":"#4f4";if(a.setAttribute("color",s),1==e.enableWicks){var h=document.createElement("a-box");a.appendChild(h),h.setAttribute("width",c/5),h.setAttribute("depth",c/5);var l=d(i.high)-d(i.low);h.setAttribute("height",l+.01),h.setAttribute("color",s)}}),1==e.enableBackground){var f=document.createElement("a-box");t.appendChild(f),f.setAttribute("width",a),f.setAttribute("height",r),f.setAttribute("depth",.05),f.setAttribute("color",e.backgroundColor),f.setAttribute("position",a/2+" "+r/2+" "+(-c-.05)/2)}if(1==e.enableTitle){var p=document.createElement("a-text");t.appendChild(p),p.setAttribute("value",n.meta.symbol+" | "+n.meta.interval),p.setAttribute("font","roboto"),p.setAttribute("position","0 0.155 "+-c/2)}if(1==e.enablePrices){var m=document.createElement("a-text");t.appendChild(m),m.setAttribute("scale",".75 .75 1"),m.setAttribute("font","roboto"),m.setAttribute("align","right"),m.setAttribute("value",""+Math.round(100*l)/100),m.setAttribute("position",a+" 0.1 "+-c/2);var A=document.createElement("a-text");t.appendChild(A),A.setAttribute("scale",".75 .75 1"),A.setAttribute("font","roboto"),A.setAttribute("align","right"),A.setAttribute("value",""+Math.round(100*h)/100),A.setAttribute("position",a+" "+(r-.1)+" "+-c/2)}}}),AFRAME.registerComponent("crypto-chart",{schema:{id:{default:"Ethereum"},days:{default:14},refreshRate:{default:1},width:{default:4},height:{default:2},backgroundColor:{default:"#333"},enableBackground:{default:!0},enableTitle:{default:!0},enablePrices:{default:!0},enableWicks:{default:!0}},init:function(){var t=this,i=this.data;e(i.id,i.days).then(function(e){t.timeseries=e,i.timeseries=e,t.updateChart()}),setInterval(function(){e(i.id,i.days).then(function(e){t.timeseries=e,i.timeseries=e,t.updateChart()})},1e3*i.refreshRate*60)},updateChart:function(){for(var t=this.el,e=this.data,i=e.width,a=e.height,r=e.timeseries,n=r.values,o=r.meta.numCandles;t.firstChild;)t.firstChild.remove();var u=n.map(function(t){return t.high}),s=n.map(function(t){return t.low}),h=Math.max.apply(Math,u),l=Math.min.apply(Math,s);function d(t){return(t-l)/(h-l)*a}var c=i/o,b=0;if(n.forEach(function(i){b++;var a=document.createElement("a-box");t.appendChild(a),a.setAttribute("width",c),a.setAttribute("depth",c);var r=d(i.open)-d(i.close);a.setAttribute("height",Math.abs(r));var n=b*c-c/2,o=r<0?Math.abs(r)/2:Math.abs(r)/-2,u=d(i.open)+o;a.setAttribute("position",n+" "+u+" 0");var s=r<0?"#f44":"#4f4";if(a.setAttribute("color",s),1==e.enableWicks){var h=document.createElement("a-box");a.appendChild(h),h.setAttribute("width",c/5),h.setAttribute("depth",c/5);var l=d(i.high)-d(i.low);h.setAttribute("height",l+.01),h.setAttribute("color",s)}}),1==e.enableBackground){var f=document.createElement("a-box");t.appendChild(f),f.setAttribute("width",i),f.setAttribute("height",a),f.setAttribute("depth",.05),f.setAttribute("color",e.backgroundColor),f.setAttribute("position",i/2+" "+a/2+" "+(-c-.05)/2)}if(1==e.enableTitle){var p=document.createElement("a-text");t.appendChild(p),p.setAttribute("value",r.meta.symbol+" | "+r.meta.interval),p.setAttribute("font","roboto"),p.setAttribute("position","0 0.155 "+-c/2)}if(1==e.enablePrices){var m=document.createElement("a-text");t.appendChild(m),m.setAttribute("scale",".75 .75 1"),m.setAttribute("font","roboto"),m.setAttribute("align","right"),m.setAttribute("value",""+Math.round(100*l)/100),m.setAttribute("position",i+" 0.1 "+-c/2);var A=document.createElement("a-text");t.appendChild(A),A.setAttribute("scale",".75 .75 1"),A.setAttribute("font","roboto"),A.setAttribute("align","right"),A.setAttribute("value",""+Math.round(100*h)/100),A.setAttribute("position",i+" "+(a-.1)+" "+-c/2)}}});
//# sourceMappingURL=aframe-stock-ticker.js.map
