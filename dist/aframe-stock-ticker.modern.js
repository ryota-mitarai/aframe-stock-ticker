function t(t,e,i,s){return new Promise((a,n)=>{fetch(`https://twelve-data1.p.rapidapi.com/time_series?symbol=${t}&interval=${e}&outputsize=${i}&format=json`,{method:"GET",headers:{"x-rapidapi-key":s,"x-rapidapi-host":"twelve-data1.p.rapidapi.com"}}).then(t=>{t.json().then(t=>{a(t)})}).catch(t=>{n(t)})})}function e(t,e){return new Promise((i,s)=>{fetch(`https://api.coingecko.com/api/v3/coins/ethereum/ohlc?vs_currency=usd&days=${e}`).then(s=>{s.json().then(s=>{const a=[];s.forEach(t=>{a.push({open:t[1],high:t[2],low:t[3],close:t[4]})});const n=e<=2?"30 min":e>=31?"4 day":"4 hour",o=Math.ceil(e<=2?24*e/.5:e>=31?e/4:24*e/4)+1;i({meta:{symbol:t,interval:n,numCandles:o},values:a})})}).catch(t=>{s(t)})})}AFRAME.registerComponent("stock-chart",{schema:{symbol:{default:"AMC"},interval:{default:"15min"},length:{default:100},refreshRate:{default:5},width:{default:4},height:{default:2},backgroundColor:{default:"#333"},enableBackground:{default:!0},enableTitle:{default:!0},enablePrices:{default:!0},enableWicks:{default:!0}},init:function(){const e=this.data;t(e.symbol,e.interval,e.length,window.TWELVE_API_KEY).then(t=>{this.timeseries=t,e.timeseries=t,this.updateChart()}),setInterval(()=>{t(e.symbol,e.interval,e.length,window.TWELVE_API_KEY).then(t=>{this.timeseries=t,e.timeseries=t,this.updateChart()})},1e3*e.refreshRate*60)},updateChart:function(){const t=this.el,e=this.data,{length:i,width:s,height:a,timeseries:n}=e,o=n.values;for(;t.firstChild;)t.firstChild.remove();const r=o.map(t=>t.high),h=o.map(t=>t.low),u=Math.max(...r),l=Math.min(...h);function d(t){return(t-l)/(u-l)*a}const c=s/i;let b=0;if(o.forEach(i=>{b++;const s=document.createElement("a-box");t.appendChild(s),s.setAttribute("width",c),s.setAttribute("depth",c);const a=d(i.open)-d(i.close);s.setAttribute("height",Math.abs(a));const n=b*c-c/2,o=a<0?Math.abs(a)/2:Math.abs(a)/-2,r=d(i.open)+o;s.setAttribute("position",`${n} ${r} 0`);const h=a<0?"#f44":"#4f4";if(s.setAttribute("color",h),1==e.enableWicks){const t=document.createElement("a-box");s.appendChild(t),t.setAttribute("width",c/5),t.setAttribute("depth",c/5);const e=d(i.high)-d(i.low);t.setAttribute("height",e+.01),t.setAttribute("color",h)}}),1==e.enableBackground){const i=document.createElement("a-box");t.appendChild(i);const n=.05;i.setAttribute("width",s),i.setAttribute("height",a),i.setAttribute("depth",n),i.setAttribute("color",e.backgroundColor),i.setAttribute("position",`${s/2} ${a/2} ${(-c-n)/2}`)}if(1==e.enableTitle){const e=document.createElement("a-text");t.appendChild(e),e.setAttribute("value",`${n.meta.symbol} | ${n.meta.interval}`),e.setAttribute("font","roboto"),e.setAttribute("position","0 0.155 "+-c/2)}if(1==e.enablePrices){const e=.1,i=document.createElement("a-text");t.appendChild(i),i.setAttribute("scale",".75 .75 1"),i.setAttribute("font","roboto"),i.setAttribute("align","right"),i.setAttribute("value",""+Math.round(100*l)/100),i.setAttribute("position",`${s} ${e} ${-c/2}`);const n=document.createElement("a-text");t.appendChild(n),n.setAttribute("scale",".75 .75 1"),n.setAttribute("font","roboto"),n.setAttribute("align","right"),n.setAttribute("value",""+Math.round(100*u)/100),n.setAttribute("position",`${s} ${a-e} ${-c/2}`)}}}),AFRAME.registerComponent("crypto-chart",{schema:{id:{default:"Ethereum"},days:{default:14},refreshRate:{default:1},width:{default:4},height:{default:2},backgroundColor:{default:"#333"},enableBackground:{default:!0},enableTitle:{default:!0},enablePrices:{default:!0},enableWicks:{default:!0}},init:function(){const t=this.data;e(t.id,t.days).then(e=>{this.timeseries=e,t.timeseries=e,this.updateChart()}),setInterval(()=>{e(t.id,t.days).then(e=>{this.timeseries=e,t.timeseries=e,this.updateChart()})},1e3*t.refreshRate*60)},updateChart:function(){const t=this.el,e=this.data,{width:i,height:s,timeseries:a}=e,n=a.values,o=a.meta.numCandles;for(;t.firstChild;)t.firstChild.remove();const r=n.map(t=>t.high),h=n.map(t=>t.low),u=Math.max(...r),l=Math.min(...h);function d(t){return(t-l)/(u-l)*s}const c=i/o;let b=0;if(n.forEach(i=>{b++;const s=document.createElement("a-box");t.appendChild(s),s.setAttribute("width",c),s.setAttribute("depth",c);const a=d(i.open)-d(i.close);s.setAttribute("height",Math.abs(a));const n=b*c-c/2,o=a<0?Math.abs(a)/2:Math.abs(a)/-2,r=d(i.open)+o;s.setAttribute("position",`${n} ${r} 0`);const h=a<0?"#f44":"#4f4";if(s.setAttribute("color",h),1==e.enableWicks){const t=document.createElement("a-box");s.appendChild(t),t.setAttribute("width",c/5),t.setAttribute("depth",c/5);const e=d(i.high)-d(i.low);t.setAttribute("height",e+.01),t.setAttribute("color",h)}}),1==e.enableBackground){const a=document.createElement("a-box");t.appendChild(a);const n=.05;a.setAttribute("width",i),a.setAttribute("height",s),a.setAttribute("depth",n),a.setAttribute("color",e.backgroundColor),a.setAttribute("position",`${i/2} ${s/2} ${(-c-n)/2}`)}if(1==e.enableTitle){const e=document.createElement("a-text");t.appendChild(e),e.setAttribute("value",`${a.meta.symbol} | ${a.meta.interval}`),e.setAttribute("font","roboto"),e.setAttribute("position","0 0.155 "+-c/2)}if(1==e.enablePrices){const e=.1,a=document.createElement("a-text");t.appendChild(a),a.setAttribute("scale",".75 .75 1"),a.setAttribute("font","roboto"),a.setAttribute("align","right"),a.setAttribute("value",""+Math.round(100*l)/100),a.setAttribute("position",`${i} ${e} ${-c/2}`);const n=document.createElement("a-text");t.appendChild(n),n.setAttribute("scale",".75 .75 1"),n.setAttribute("font","roboto"),n.setAttribute("align","right"),n.setAttribute("value",""+Math.round(100*u)/100),n.setAttribute("position",`${i} ${s-e} ${-c/2}`)}}});
//# sourceMappingURL=aframe-stock-ticker.modern.js.map
