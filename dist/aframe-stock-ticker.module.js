AFRAME.registerComponent("stock-chart",{schema:{symbol:{default:"ETH/USD"},interval:{default:"15min"},length:{default:100},refreshRate:{default:5},width:{default:4},height:{default:2},enableBackground:{default:!0},backgroundColor:{default:"#333"},enableTitle:{default:!0},enablePrices:{default:!0},enableWicks:{default:!0},coloredWicks:{default:!0}},init:function(){var t,e,a,i,r=this,n=this.data;setInterval((t=n.symbol,e=n.interval,a=n.length,i=window.TWELVE_API_KEY,new Promise(function(r,n){fetch("https://twelve-data1.p.rapidapi.com/time_series?symbol="+t+"&interval="+e+"&outputsize="+a+"&format=json",{method:"GET",headers:{"x-rapidapi-key":i,"x-rapidapi-host":"twelve-data1.p.rapidapi.com"}}).then(function(t){t.json().then(function(t){r(t)})}).catch(function(t){n(t)})})).then(function(t){n.timeseries=t,r.updateChart()}),1e3*n.refreshRate*60)},updateChart:function(){for(var t=this.el,e=this.data,a=e.length,i=e.width,r=e.height,n=e.timeseries,o=n.values;t.firstChild;)t.firstChild.remove();var s=o.map(function(t){return t.high}),u=o.map(function(t){return t.low}),l=Math.max.apply(Math,s),h=Math.min.apply(Math,u);function d(t){return(t-h)/(l-h)*r}var b=i/a,c=0;if(o.forEach(function(a){c++;var i=document.createElement("a-box");t.appendChild(i),i.setAttribute("width",b),i.setAttribute("depth",b);var r=d(a.open)-d(a.close);i.setAttribute("height",Math.abs(r));var n=c*b-b/2,o=r<0?Math.abs(r)/2:Math.abs(r)/-2,s=d(a.open)+o;i.setAttribute("position",n+" "+s+" 0");var u=r<0?"#f44":"#4f4";if(i.setAttribute("color",u),1==e.enableWicks){var l=document.createElement("a-box");i.appendChild(l),l.setAttribute("width",b/5),l.setAttribute("depth",b/5);var h=d(a.high)-d(a.low);l.setAttribute("height",h+.01),l.setAttribute("color",1==e.coloredWicks?u:"#000")}}),1==e.enableBackground){var p=document.createElement("a-box");t.appendChild(p),p.setAttribute("width",i),p.setAttribute("height",r),p.setAttribute("depth",.05),p.setAttribute("color",e.backgroundColor),p.setAttribute("position",i/2+" "+r/2+" "+(-b-.05)/2)}if(1==e.enableTitle){var f=document.createElement("a-text");t.appendChild(f),f.setAttribute("value",n.meta.symbol+" | "+n.meta.interval),f.setAttribute("font","roboto"),f.setAttribute("position","0 0.155 "+-b/2)}if(1==e.enablePrices){var m=document.createElement("a-text");t.appendChild(m),m.setAttribute("scale",".75 .75 1"),m.setAttribute("font","roboto"),m.setAttribute("align","right"),m.setAttribute("value",""+Math.round(100*h)/100),m.setAttribute("position",i+" 0.1 "+-b/2);var A=document.createElement("a-text");t.appendChild(A),A.setAttribute("scale",".75 .75 1"),A.setAttribute("font","roboto"),A.setAttribute("align","right"),A.setAttribute("value",""+Math.round(100*l)/100),A.setAttribute("position",i+" "+(r-.1)+" "+-b/2)}}});
//# sourceMappingURL=aframe-stock-ticker.module.js.map
