!function(t){"function"==typeof define&&define.amd?define(t):t()}(function(){AFRAME.registerComponent("stock-ticker",{schema:{symbol:{default:"ETH/USD"},interval:{default:"15min"},length:{default:100},refreshRate:{default:5},width:{default:4},height:{default:2},enableBackground:{default:!0},backgroundColor:{default:"#333"},enableTitle:{default:!0},enablePrices:{default:!0},enableWicks:{default:!0},coloredWicks:{default:!0}},init:function(){var t,e,i,a,r=this,n=this.data;setInterval((t=n.symbol,e=n.interval,i=n.length,a=window.TWELVE_API_KEY,new Promise(function(r,n){fetch("https://twelve-data1.p.rapidapi.com/time_series?symbol="+t+"&interval="+e+"&outputsize="+i+"&format=json",{method:"GET",headers:{"x-rapidapi-key":a,"x-rapidapi-host":"twelve-data1.p.rapidapi.com"}}).then(function(t){t.json().then(function(t){r(t)})}).catch(function(t){n(t)})})).then(function(t){n.timeseries=t,r.updateChart()}),1e3*n.refreshRate*60)},updateChart:function(){for(var t=this.el,e=this.data,i=e.length,a=e.width,r=e.height,n=e.timeseries,o=n.values;t.firstChild;)t.firstChild.remove();var u=o.map(function(t){return t.high}),s=o.map(function(t){return t.low}),l=Math.max.apply(Math,u),d=Math.min.apply(Math,s);function h(t){return(t-d)/(l-d)*r}var c=a/i,b=0;if(o.forEach(function(i){b++;var a=document.createElement("a-box");t.appendChild(a),a.setAttribute("width",c),a.setAttribute("depth",c);var r=h(i.open)-h(i.close);a.setAttribute("height",Math.abs(r));var n=b*c-c/2,o=r<0?Math.abs(r)/2:Math.abs(r)/-2,u=h(i.open)+o;a.setAttribute("position",n+" "+u+" 0");var s=r<0?"#f44":"#4f4";if(a.setAttribute("color",s),1==e.enableWicks){var l=document.createElement("a-box");a.appendChild(l),l.setAttribute("width",c/5),l.setAttribute("depth",c/5);var d=h(i.high)-h(i.low);l.setAttribute("height",d+.01),l.setAttribute("color",1==e.coloredWicks?s:"#000")}}),1==e.enableBackground){var f=document.createElement("a-box");t.appendChild(f),f.setAttribute("width",a),f.setAttribute("height",r),f.setAttribute("depth",.05),f.setAttribute("color",e.backgroundColor),f.setAttribute("position",a/2+" "+r/2+" "+(-c-.05)/2)}if(1==e.enableTitle){var p=document.createElement("a-text");t.appendChild(p),p.setAttribute("value",n.meta.symbol+" | "+n.meta.interval),p.setAttribute("font","roboto"),p.setAttribute("position","0 0.155 "+-c/2)}if(1==e.enablePrices){var m=document.createElement("a-text");t.appendChild(m),m.setAttribute("scale",".75 .75 1"),m.setAttribute("font","roboto"),m.setAttribute("align","right"),m.setAttribute("value",""+Math.round(100*d)/100),m.setAttribute("position",a+" 0.1 "+-c/2);var A=document.createElement("a-text");t.appendChild(A),A.setAttribute("scale",".75 .75 1"),A.setAttribute("font","roboto"),A.setAttribute("align","right"),A.setAttribute("value",""+Math.round(100*l)/100),A.setAttribute("position",a+" "+(r-.1)+" "+-c/2)}}})});
//# sourceMappingURL=aframe-stock-ticker.umd.js.map
